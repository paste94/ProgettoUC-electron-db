/**
	Kailash Nadh,	http://kailashnadh.name
	September 2011
	Smooth popup dialog for jQuery
	http://kailashnadh.name/code/jqdialog

	License: GPL
**/

(function(e){var t=null;e.jqDialog={escape_callback:null,enter_callback:null,active:false,close_timer:null,labels:{ok:"Ok",yes:"Yes",no:"No",cancel:"Cancel"},ids:{div_box:"jqDialog_box",div_content:"jqDialog_content",div_options:"jqDialog_options",bt_yes:"jqDialog_yes",bt_no:"jqDialog_no",bt_ok:"jqDialog_ok",bt_ancel:"jqDialog_ok",input:"jqDialog_input"},confirm:function(e,n,r){t.create(e);t.parts.bt_ok.hide();t.parts.bt_cancel.hide();t.parts.bt_yes.show();t.parts.bt_no.show();t.parts.bt_yes.focus();t.parts.bt_yes.unbind().click(function(){t.cleanKeypressCallbacks();t.close();if(n)n()});t.enter_callback=function(){if(n)n()};t.parts.bt_no.unbind().click(function(){t.cleanKeypressCallbacks();t.close();if(r)r()});t.escape_callback=function(){if(r)r()}},prompt:function(n,r,i,s){t.create(e("<div>").append(n).append(e("<div>").append(t.parts.input.val(r))));t.parts.bt_yes.hide();t.parts.bt_no.hide();t.parts.bt_ok.show();t.parts.bt_cancel.show();t.parts.input.focus();t.parts.bt_ok.unbind().click(function(){t.cleanKeypressCallbacks();t.close();if(i)i(t.parts.input.val())});t.enter_callback=function(){if(i)i(t.parts.input.val())};t.parts.bt_cancel.unbind().click(function(){t.cleanKeypressCallbacks();t.close();if(s)s()});t.escape_callback=function(){if(s)s()}},alert:function(e,n){t.create(e);t.parts.bt_cancel.hide();t.parts.bt_yes.hide();t.parts.bt_no.hide();t.parts.bt_ok.show();t.parts.bt_ok.focus();t.parts.bt_ok.unbind().click(function(){t.cleanKeypressCallbacks();t.close();if(n){n()}});t.escape_callback=function(){if(n){n()}}},content:function(e,n){t.create(e);t.parts.div_options.hide()},notify:function(e,n){t.content(e);if(n){t.close_timer=setTimeout(function(){t.close()},n*1e3)}},create:function(e){window.clearTimeout(t.close_timer);t.check();t.maintainPosition(t.parts.div_box);clearTimeout(t.close_timer);t.parts.div_content.html(e);t.parts.div_options.show();if(!t.active){t.parts.div_box.fadeIn("fast")}else{t.parts.div_box.show()}t.active=true},close:function(){t.close_timer=window.setTimeout(function(){t.parts.div_box.fadeOut("fast");t.clearPosition();t.active=false})},clearPosition:function(){e(window).unbind("scroll.jqDialog")},makeCenter:function(t){t.css({top:e(window).height()/2-t.height()/2+e(document).scrollTop()+"px",left:e(window).width()/2-t.width()/2+e(document).scrollLeft()+"px"})},maintainPosition:function(n){t.makeCenter(n);e(window).bind("scroll.jqDialog",function(){t.makeCenter(n)})},init_done:false,check:function(){if(t.init_done)return;else{t.init_done=true}e("body").append(t.parts.div_box)},init:function(){t.parts={};t.parts.div_box=e("<div>").attr({id:t.ids.div_box});t.parts.div_content=e("<div>").attr({id:t.ids.div_content});t.parts.div_options=e("<div>").attr({id:t.ids.div_options});t.parts.bt_yes=e("<button>").attr({id:t.ids.bt_yes}).append(t.labels.yes);t.parts.bt_no=e("<button>").attr({id:t.ids.bt_no}).append(t.labels.no);t.parts.bt_ok=e("<button>").attr({id:t.ids.bt_ok}).append(t.labels.ok);t.parts.bt_cancel=e("<button>").attr({id:t.ids.bt_cancel}).append(t.labels.cancel);t.parts.input=e("<input>").attr({id:t.ids.input});t.parts.div_box.append(t.parts.div_content).append(t.parts.div_options.append(t.parts.bt_yes).append(t.parts.bt_no).append(t.parts.bt_ok).append(t.parts.bt_cancel));t.parts.div_box.hide();e(document).keyup(function(e){if(e.altKey)return;if(e.keyCode==13){t.enterPressed()}if(e.keyCode==27){t.escapePressed()}})},cleanKeypressCallbacks:function(){t.enter_callback=null;t.escape_callback=null},escapePressed:function(){t.close();if(t.escape_callback){t.enter_callback=null;t.escape_callback();t.escape_callback=null}},enterPressed:function(){t.close();if(t.enter_callback){t.escape_callback=null;t.enter_callback();t.enter_callback=null}}};t=e.jqDialog;e.jqDialog.init()})(jQuery);
